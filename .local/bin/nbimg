#!/bin/sh

file="${XDG_CACHE_HOME:-$HOME/.cache}/newsboat/nbimg.jpg"

if [[ "$1" =~ https?://imgur.com/.* ]]
then
	url=$(echo $1.jpg | sed "s/\/i/\/i\.i/")
else
	url="$1"
fi

wget -O "$file" "$url" 2> /dev/null || ( notify-send "Error" && rm $file && exit )

pgrep -f "sxiv -b $HOME/.cache/newsboat/nbimg.jpg" > /dev/null && exit || sxiv -b $file 2>/dev/null && rm $file
