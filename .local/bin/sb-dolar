#!/bin/sh
file="$HOME/.local/share/dolar"

update(){
	rm $file
	curl -s "https://dolarhoy.com/cotizaciondolaroficial" > $file
	curl -s "https://dolarhoy.com/cotizaciondolarblue" >> $file
	blueventa=$(grep -Eo "\"value\".{20}" $file | grep -Eo "[0-9]*\.[0-9]*" | tail -n1)
}

if [[ $(stat -c %y $file | cut -d' ' -f1) !=  $(date -I) ]]
then
	update
fi

compra=$(grep -Eo "\"value\".{20}" $file | grep -Eo "[0-9]*\.[0-9]*" | head -n1 )
venta=$(grep -Eo "\"value\".{20}" $file | grep -Eo "[0-9]*\.[0-9]*" | sed "2q" | tail -n1)

bluecompra=$(grep -Eo "\"value\".{20}" $file | grep -Eo "[0-9]*\.[0-9]*" | sed "3q" | tail -n1)
blueventa=$(grep -Eo "\"value\".{20}" $file | grep -Eo "[0-9]*\.[0-9]*" | tail -n1)

case $BLOCK_BUTTON in
	1) notify-send \
"ðŸ’µ Oficial ðŸ’µ
Compra: \$$compra
Venta:  \$$venta
ðŸ’µ Blue ðŸ’µ
Compra: \$$bluecompra 
Venta:  \$$blueventa" ;;
	2) update ;;
	3) $TERMINAL -e $EDITOR "$0";;
esac

echo $blueventa
