#!/bin/sh

#tempfile="$(mktemp)"
tempfile="$XDG_CACHE_HOME/curly"
method="$1"
endpoint="$2"
JQ_COLORS="1;32:0;35:0;35:1;33:0;32:1;37:1;39"

if [ "$method" = "get" ]; then
	curl -s "$endpoint" "$@" | jq
else 
	#nvim  -c 'set filetype=json' -c "startinsert" "$tempfile"
	nvim  -c 'set filetype=json' "$tempfile"
	case "$method" in
		"post")
			curl -s --json @"$tempfile" -X POST "$endpoint" "$@" | jq ;;
		"put")
			curl -s --json @"$tempfile" -X PUT "$endpoint" "$@" | jq ;;
		"delete")
			curl -s -X DELETE "$endpoint" "$@" | jq ;;
	esac
	#rm "$tempfile"
fi
